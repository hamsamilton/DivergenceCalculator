% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TDfunctions.R
\name{CalcDivergence}
\alias{CalcDivergence}
\title{Calculate transcriptomic divergence metrics}
\usage{
CalcDivergence(cpmdf, metric = "P50/P50")
}
\arguments{
\item{cpmdf}{A depth-corrected data frame (e.g., CPM or FPKM), where rows are genes and columns are samples.}

\item{metric}{The divergence metric to calculate. Default is "P50/P50". Options include:
\itemize{
\item "P50/P50": Ratio of sum of top 50\% expressed genes to bottom 50\%
\item "P20": Ratio of sum of top 20\% expressed genes to bottom 20\%
\item "P10": Ratio of sum of top 10\% expressed genes to bottom 10\%
\item "sd": Standard deviation of gene expression values
\item "kurtosis": Kurtosis of gene expression distribution
\item "gini": Gini coefficient of gene expression values
}}
}
\value{
A data frame with two columns:
\itemize{
\item dvrgnc: The calculated divergence value for each sample
\item clnames: The sample names
}
}
\description{
Calculates various metrics of transcriptomic divergence across samples.
}
\details{
This function automatically removes genes with zero counts before calculating metrics.
}
\examples{
\dontrun{
# Calculate P50/P50 (default)
p50_divergence <- mkdvrgnc(normalized_counts)

# Calculate Gini coefficient
gini_divergence <- mkdvrgnc(normalized_counts, metric = "gini")

# Plot divergence metrics
library(ggplot2)
ggplot(p50_divergence, aes(x = clnames, y = dvrgnc)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "P50/P50 Divergence by Sample",
       x = "Sample",
       y = "P50/P50 Ratio")
}

}
